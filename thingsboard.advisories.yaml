schema-version: 2.0.2

package:
  name: thingsboard

advisories:
  - id: CGA-2c95-vj5f-q7g6
    aliases:
      - CVE-2024-12801
      - GHSA-6v67-2wr5-gvf4
    events:
      - timestamp: 2024-12-20T11:09:31Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: cb5bb93ac9484ef0
            componentName: logback-core
            componentVersion: 1.5.5
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype

  - id: CGA-39xg-q8v3-42r5
    aliases:
      - CVE-2024-12798
      - GHSA-pr98-23f8-jwxv
    events:
      - timestamp: 2024-12-20T11:09:38Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: cb5bb93ac9484ef0
            componentName: logback-core
            componentVersion: 1.5.5
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype

  - id: CGA-542v-cxhr-j3qf
    aliases:
      - CVE-2022-24329
      - GHSA-2qp4-g3q3-f92w
    events:
      - timestamp: 2024-08-29T15:31:00Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 730b921db921b24d
            componentName: kotlin-stdlib
            componentVersion: 1.4.10
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-09-08T08:04:05Z
        type: fixed
        data:
          fixed-version: 3.7-r1

  - id: CGA-55jj-mx8g-6m6j
    aliases:
      - CVE-2024-31141
      - GHSA-2x2g-32r7-p4x8
    events:
      - timestamp: 2024-11-20T08:18:55Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: d69d2dcfe7c63458
            componentName: kafka-clients
            componentVersion: 3.7.0
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-12-19T17:33:13Z
        type: fixed
        data:
          fixed-version: 3.8.1-r4

  - id: CGA-5749-245m-24vg
    aliases:
      - CVE-2024-50379
      - GHSA-5j33-cvvr-w245
    events:
      - timestamp: 2024-12-28T10:14:45Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 5a6d14c989d55779
            componentName: tomcat-embed-core
            componentVersion: 10.1.33
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype

  - id: CGA-63mv-w982-8q6x
    aliases:
      - CVE-2023-52428
      - GHSA-gvpg-vgmx-xg6w
    events:
      - timestamp: 2024-08-29T15:31:05Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: dcd2ffba3ff15228
            componentName: nimbus-jose-jwt
            componentVersion: 9.8.1
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-09-11T03:03:56Z
        type: fixed
        data:
          fixed-version: 3.7-r2

  - id: CGA-6xwj-3x88-p9hm
    aliases:
      - CVE-2024-7254
      - GHSA-735f-pc8j-v9w8
    events:
      - timestamp: 2024-09-21T08:09:20Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 9ab3b9987824d207
            componentName: protobuf-java
            componentVersion: 3.25.3
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype

  - id: CGA-74gc-8gj9-c3vp
    aliases:
      - CVE-2024-38809
      - GHSA-2rmj-mq67-h97g
    events:
      - timestamp: 2024-09-26T08:36:55Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 6f41a391aa9d8065
            componentName: spring-web
            componentVersion: 6.1.6
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype

  - id: CGA-895x-8fhr-cfcr
    aliases:
      - CVE-2021-31684
      - GHSA-fg2v-w576-w4v3
    events:
      - timestamp: 2024-08-29T15:31:03Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 229ac4b92b5464e8
            componentName: json-smart
            componentVersion: 1.3.2
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-09-11T09:26:55Z
        type: pending-upstream-fix
        data:
          note: This vulnerability requires the upgrade of other packages which creates conflicts when building this package.
      - timestamp: 2024-09-16T11:36:13Z
        type: fixed
        data:
          fixed-version: 3.7-r4

  - id: CGA-97fq-p5p8-prgr
    aliases:
      - CVE-2023-1370
      - GHSA-493p-pfq6-5258
    events:
      - timestamp: 2024-08-29T15:31:01Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 229ac4b92b5464e8
            componentName: json-smart
            componentVersion: 1.3.2
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-09-16T11:36:12Z
        type: fixed
        data:
          fixed-version: 3.7-r4

  - id: CGA-99vm-8q2m-vxj6
    aliases:
      - CVE-2024-53990
      - GHSA-mfj5-cf8g-g2fv
    events:
      - timestamp: 2024-12-13T10:36:53Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 4e434a90b0dac877
            componentName: async-http-client
            componentVersion: 2.12.1
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype

  - id: CGA-9cw3-8w4j-827w
    aliases:
      - CVE-2024-43799
      - GHSA-m6fv-jmcg-4jfg
    events:
      - timestamp: 2024-09-11T18:15:07Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: c0ac71c93279ed82
            componentName: send
            componentVersion: 0.18.0
            componentType: npm
            componentLocation: /usr/share/tb-js-executor/node_modules/serve-static/node_modules/send/package.json
            scanner: grype
      - timestamp: 2024-09-16T11:36:13Z
        type: fixed
        data:
          fixed-version: 3.7-r4

  - id: CGA-9g9w-93jp-5j27
    aliases:
      - CVE-2024-47535
      - GHSA-xq3w-v528-46rv
    events:
      - timestamp: 2024-11-14T08:12:53Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 0956ecb2b9d56b27
            componentName: netty-common
            componentVersion: 4.1.109.Final
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-11-18T16:16:21Z
        type: fixed
        data:
          fixed-version: 3.8.1-r3
      - timestamp: 2024-11-20T20:03:43Z
        type: false-positive-determination
        data:
          type: vulnerable-code-cannot-be-controlled-by-adversary
          note: Vulnerability affects only Windows systems.

  - id: CGA-crm9-p3mr-qc4q
    aliases:
      - CVE-2020-29582
      - GHSA-cqj8-47ch-rvvq
    events:
      - timestamp: 2024-08-29T15:31:02Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 730b921db921b24d
            componentName: kotlin-stdlib
            componentVersion: 1.4.10
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-09-08T08:04:04Z
        type: fixed
        data:
          fixed-version: 3.7-r1

  - id: CGA-cv8c-2cc7-fqx5
    aliases:
      - CVE-2024-38821
      - GHSA-c4q5-6c82-3qpw
    events:
      - timestamp: 2024-10-29T07:21:02Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard-tb-js-executor
            componentID: 0140fd96d750cfd1
            componentName: spring-security-web
            componentVersion: 6.2.3
            componentType: java-archive
            componentLocation: /usr/share/thingsboard/bin/thingsboard.jar
            scanner: grype
      - timestamp: 2024-11-15T11:07:06Z
        type: fixed
        data:
          fixed-version: 3.8.1-r2

  - id: CGA-gvqr-m7rp-72vj
    aliases:
      - CVE-2023-3635
      - GHSA-w33c-445m-f8w7
    events:
      - timestamp: 2024-08-29T15:31:07Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 5f77eb05126605f9
            componentName: okio
            componentVersion: 2.8.0
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-09-11T03:03:57Z
        type: fixed
        data:
          fixed-version: 3.7-r2

  - id: CGA-mx8q-5h2r-92gg
    aliases:
      - CVE-2024-47764
      - GHSA-pxg6-pf52-xh8x
    events:
      - timestamp: 2024-10-05T07:42:38Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: d771f227d94ceff3
            componentName: cookie
            componentVersion: 0.6.0
            componentType: npm
            componentLocation: /usr/share/tb-js-executor/node_modules/cookie/package.json
            scanner: grype

  - id: CGA-vjmv-g97f-36p7
    aliases:
      - CVE-2024-52798
      - GHSA-rhx6-c78j-4q9w
    events:
      - timestamp: 2024-12-06T10:17:30Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 0f97581f353a759a
            componentName: path-to-regexp
            componentVersion: 0.1.10
            componentType: npm
            componentLocation: /usr/share/tb-js-executor/node_modules/path-to-regexp/package.json
            scanner: grype
      - timestamp: 2024-12-19T17:33:14Z
        type: fixed
        data:
          fixed-version: 3.8.1-r4

  - id: CGA-x4j9-cwr8-9r3c
    aliases:
      - CVE-2024-38816
      - GHSA-cx7f-g6mp-7hqm
    events:
      - timestamp: 2024-09-14T09:22:03Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: f0765f22513fa808
            componentName: spring-webmvc
            componentVersion: 6.1.5
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-09-15T09:20:27Z
        type: pending-upstream-fix
        data:
          note: This vulnerability requires upstream changes. An upgrade to a non-vulnerable version breaks the current source code.
      - timestamp: 2024-11-15T11:07:05Z
        type: fixed
        data:
          fixed-version: 3.8.1-r2

  - id: CGA-x8g8-9rwj-j985
    aliases:
      - CVE-2024-45296
      - GHSA-9wv6-86v2-598j
    events:
      - timestamp: 2024-09-10T15:29:41Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: ef8d70d2478dbcc3
            componentName: path-to-regexp
            componentVersion: 0.1.7
            componentType: npm
            componentLocation: /usr/share/tb-js-executor/node_modules/path-to-regexp/package.json
            scanner: grype
      - timestamp: 2024-09-11T03:03:55Z
        type: fixed
        data:
          fixed-version: 3.7-r2

  - id: CGA-xqp6-884p-65f9
    aliases:
      - CVE-2024-38820
      - GHSA-4gc7-5j7h-4qph
    events:
      - timestamp: 2024-10-19T08:10:12Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard-tb-js-executor
            componentID: c9931e8ac66852c3
            componentName: spring-context
            componentVersion: 6.1.6
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-11-09T02:01:17Z
        type: fixed
        data:
          fixed-version: 3.8.1-r1

  - id: CGA-xv4j-9m39-wrpw
    aliases:
      - CVE-2024-34750
      - GHSA-wm9w-rjj3-j356
    events:
      - timestamp: 2024-08-29T15:31:09Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 403b9c98057d8207
            componentName: tomcat-embed-core
            componentVersion: 10.1.19
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-09-11T03:03:56Z
        type: fixed
        data:
          fixed-version: 3.7-r2
      - timestamp: 2024-11-09T02:02:28Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: thingsboard
            componentID: 403b9c98057d8207
            componentName: tomcat-embed-core
            componentVersion: 10.1.19
            componentType: java-archive
            componentLocation: /usr/share/tb-mqtt-transport/bin/tb-mqtt-transport.jar
            scanner: grype
      - timestamp: 2024-11-13T16:31:23Z
        type: pending-upstream-fix
        data:
          note: This was able to be bumped prior to thingsboard 3.8, however when this is bumped now runtime issues occur in thingsboard-tb-node.
