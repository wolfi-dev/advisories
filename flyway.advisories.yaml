schema-version: 2.0.2

package:
  name: flyway

advisories:
  - id: CGA-5qhv-54w5-c6pw
    aliases:
      - CVE-2025-25193
      - GHSA-389x-839f-4rhx
    events:
      - timestamp: 2025-02-11T09:20:04Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 2dcc4874fa1813d4
            componentName: netty-common
            componentVersion: 4.1.115.Final
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/lib/netty/netty-common-4.1.115.Final.jar
            scanner: grype
      - timestamp: 2025-02-13T19:42:52Z
        type: false-positive-determination
        data:
          type: vulnerable-code-cannot-be-controlled-by-adversary
          note: Vulnerability affects only Windows systems.

  - id: CGA-7vpq-jvgf-5q9p
    aliases:
      - CVE-2025-59250
      - GHSA-m494-w24q-6f7w
    events:
      - timestamp: 2025-11-05T07:35:07Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: df4ce0197f094f07
            componentName: mssql-jdbc
            componentVersion: 12.10.1
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/drivers/mssql-jdbc-12.10.1.jre11.jar
            scanner: grype
      - timestamp: 2025-11-06T12:43:12Z
        type: false-positive-determination
        data:
          type: vulnerable-code-version-not-used
          note: We updated to mssql-jdbc-12.10.2.jre11 which is a fixed version, but the version string matching doesn't seem to work well with the .jre11 suffix.
      - timestamp: 2025-11-06T13:54:00Z
        type: fixed
        data:
          fixed-version: 11.15.0-r1
      - timestamp: 2025-11-12T07:46:17Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: a40c6dbcd9463c75
            componentName: mssql-jdbc
            componentVersion: 12.10.2
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/drivers/mssql-jdbc-12.10.2.jre11.jar
            scanner: grype
      - timestamp: 2025-11-13T19:47:50Z
        type: false-positive-determination
        data:
          type: vulnerable-code-not-included-in-package
          note: |
            The affected component's suffix is non-standard for Maven parsing. It supports "." as a delimiter, but treats jre11 as an unknown qualifier that sorts after known ones (alpha, beta, rc, ga, etc.), which breaks version matching. This vulnerability was resolved in flyway 11.16.0 and above[1].
            [1] https://documentation.red-gate.com/flyway/release-notes-and-older-versions/release-notes-for-flyway-engine

  - id: CGA-7vrc-vhf3-9f48
    aliases:
      - CVE-2025-58057
      - GHSA-3p8m-j85q-pgmj
    events:
      - timestamp: 2025-09-04T08:17:29Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 15a02ba0bbf7deb1
            componentName: netty-codec
            componentVersion: 4.1.118.Final
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/lib/netty/netty-codec-4.1.118.Final.jar
            scanner: grype
      - timestamp: 2025-09-04T09:39:26Z
        type: fixed
        data:
          fixed-version: 11.11.2-r1

  - id: CGA-8j78-2pm4-qqhq
    aliases:
      - CVE-2025-58056
      - GHSA-fghv-69vj-qj49
    events:
      - timestamp: 2025-09-06T07:37:10Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 176548348dec7c34
            componentName: netty-codec-http
            componentVersion: 4.1.118.Final
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/lib/netty/netty-codec-http-4.1.118.Final.jar
            scanner: grype
      - timestamp: 2025-09-06T09:33:30Z
        type: fixed
        data:
          fixed-version: 11.12.0-r1

  - id: CGA-gf5g-ppvp-f4vr
    aliases:
      - CVE-2025-55163
      - GHSA-prj3-ccx8-p6x4
    events:
      - timestamp: 2025-08-14T09:29:58Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 93e834d43e3b2773
            componentName: netty-codec-http2
            componentVersion: 4.1.118.Final
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/lib/netty/netty-codec-http2-4.1.118.Final.jar
            scanner: grype
      - timestamp: 2025-08-15T15:03:40Z
        type: fixed
        data:
          fixed-version: 11.11.0-r1

  - id: CGA-gh6g-v8p4-67xf
    aliases:
      - CVE-2025-27496
      - GHSA-q298-375f-5q63
    events:
      - timestamp: 2025-03-15T12:08:44Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: f17958fafde2be85
            componentName: snowflake-jdbc
            componentVersion: 3.22.0
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/drivers/snowflake-jdbc-3.22.0.jar
            scanner: grype
      - timestamp: 2025-03-22T08:52:00Z
        type: fixed
        data:
          fixed-version: 11.4.1-r0

  - id: CGA-h4h5-h224-vvwf
    aliases:
      - CVE-2025-22227
      - GHSA-4q2v-9p7v-3v22
    events:
      - timestamp: 2025-07-17T07:26:23Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 797543e0f19b2bd0
            componentName: reactor-netty-http
            componentVersion: 1.0.48
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/lib/aad/reactor-netty-http-1.0.48.jar
            scanner: grype
      - timestamp: 2025-07-21T09:21:43Z
        type: fixed
        data:
          fixed-version: 11.10.3-r0

  - id: CGA-hj36-5gmg-h97m
    aliases:
      - CVE-2025-24789
      - GHSA-7hpq-3g6w-pvhf
    events:
      - timestamp: 2025-01-31T07:16:32Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 5a96b9cd460b290a
            componentName: snowflake-jdbc
            componentVersion: 3.20.0
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/drivers/snowflake-jdbc-3.20.0.jar
            scanner: grype
      - timestamp: 2025-02-05T11:12:51Z
        type: fixed
        data:
          fixed-version: 11.2.0-r1

  - id: CGA-jhcq-22wf-r4wv
    aliases:
      - CVE-2020-8908
      - GHSA-5mg8-w23w-74h3
    events:
      - timestamp: 2025-01-09T23:01:04Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 2d9e4376721a687c
            componentName: guava
            componentVersion: 31.1-jre
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/drivers/databricks-jdbc-2.6.40.jar
            scanner: grype
      - timestamp: 2025-01-09T00:02:01Z
        type: pending-upstream-fix
        data:
          note: guava-31.1-jre.jar is not part of upstream repo. It is a transitive dependendcy of /flyway/drivers/databricks-jdbc-2.6.40.jar. This is not easily fixed as databricks-jdbc is closed source.
      - timestamp: 2025-01-16T22:38:00Z
        type: pending-upstream-fix
        data:
          note: guava-31.1-jre.jar is not part of upstream repo. It is a transitive dependendcy of /flyway/drivers/databricks-jdbc-2.6.40.jar. This is not easily fixed as databricks-jdbc is closed source.

  - id: CGA-jq6q-h9hm-r669
    aliases:
      - CVE-2025-48924
      - GHSA-j288-q9x7-2f5v
    events:
      - timestamp: 2025-07-12T07:04:38Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 8c96260c375fac2b
            componentName: commons-lang
            componentVersion: "2.6"
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/drivers/databricks-jdbc-2.6.40.jar
            scanner: grype
      - timestamp: 2025-07-15T16:34:25Z
        type: pending-upstream-fix
        data:
          note: This vulnerability exists in databricks-jdbc-2.6.40 which is bundled/shaded inside flyway drivers. As a pre-built binary artifact, the embedded dependencies cannot be updated independently. This requires a new upstream release of databricks-jdbc driver with updated bundled dependencies.
      - timestamp: 2025-09-30T15:47:22Z
        type: pending-upstream-fix
        data:
          note: This vulnerability exists in databricks-jdbc-2.7.3 which is bundled/shaded inside flyway drivers. As a pre-built binary artifact, the embedded dependencies cannot be updated independently. This requires a new upstream release of databricks-jdbc driver with updated bundled dependencies.

  - id: CGA-p3gx-2p4q-w594
    aliases:
      - CVE-2025-24790
      - GHSA-33g6-495w-v8j2
    events:
      - timestamp: 2025-01-31T07:16:30Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 5a96b9cd460b290a
            componentName: snowflake-jdbc
            componentVersion: 3.20.0
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/drivers/snowflake-jdbc-3.20.0.jar
            scanner: grype
      - timestamp: 2025-02-05T11:12:52Z
        type: fixed
        data:
          fixed-version: 11.2.0-r1

  - id: CGA-pvg9-5q28-6hg7
    aliases:
      - CVE-2025-53864
      - GHSA-xwmg-2g98-w7v9
    events:
      - timestamp: 2025-07-12T07:04:38Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: b8e5d95334beacf4
            componentName: nimbus-jose-jwt
            componentVersion: 9.37.2
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/drivers/databricks-jdbc-2.6.40.jar
            scanner: grype
      - timestamp: 2025-07-15T11:33:29Z
        type: pending-upstream-fix
        data:
          note: This vulnerability exists in databricks-jdbc-2.6.40 which is bundled/shaded inside flyway drivers. As a pre-built binary artifact, the embedded dependencies cannot be updated independently. This requires a new upstream release of databricks-jdbc driver with updated bundled dependencies.
      - timestamp: 2025-09-30T15:48:36Z
        type: pending-upstream-fix
        data:
          note: This vulnerability exists in databricks-jdbc-2.7.3 which is bundled/shaded inside flyway drivers. As a pre-built binary artifact, the embedded dependencies cannot be updated independently. This requires a new upstream release of databricks-jdbc driver with updated bundled dependencies.

  - id: CGA-pvmc-36v5-xpxp
    aliases:
      - CVE-2025-24970
      - GHSA-4g8c-wm8x-jfhw
    events:
      - timestamp: 2025-02-11T09:20:06Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: c412aef7d5ee8e31
            componentName: netty-handler
            componentVersion: 4.1.94.Final
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/lib/netty/netty-handler-4.1.94.Final.jar
            scanner: grype
      - timestamp: 2025-02-12T02:10:14Z
        type: fixed
        data:
          fixed-version: 11.3.1-r1

  - id: CGA-ww3c-v2pw-2hr3
    aliases:
      - CVE-2024-47535
      - GHSA-xq3w-v528-46rv
    events:
      - timestamp: 2025-01-09T23:01:07Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 92508380bb6e4545
            componentName: netty-common
            componentVersion: 4.1.86.Final
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/drivers/databricks-jdbc-2.6.40.jar
            scanner: grype
      - timestamp: 2025-01-09T00:05:31Z
        type: pending-upstream-fix
        data:
          note: netty-common-4.1.86.Final.jar is not part of upstream repo. It is a transitive dependendcy of /flyway/drivers/databricks-jdbc-2.6.40.jar. This is not easily fixed as databricks-jdbc is closed source.
      - timestamp: 2025-01-16T22:38:00Z
        type: pending-upstream-fix
        data:
          note: netty-common-4.1.86.Final.jar is not part of upstream repo. It is a transitive dependendcy of /flyway/drivers/databricks-jdbc-2.6.40.jar. This is not easily fixed as databricks-jdbc is closed source.

  - id: CGA-wwr8-cf96-jh4v
    aliases:
      - CVE-2023-2976
      - GHSA-7g45-4rm6-3mm3
    events:
      - timestamp: 2025-01-09T23:01:05Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: flyway
            componentID: 2d9e4376721a687c
            componentName: guava
            componentVersion: 31.1-jre
            componentType: java-archive
            componentLocation: /usr/share/java/flyway/drivers/databricks-jdbc-2.6.40.jar
            scanner: grype
      - timestamp: 2025-01-09T00:04:11Z
        type: pending-upstream-fix
        data:
          note: guava-31.1-jre.jar is not part of upstream repo. It is a transitive dependendcy of /flyway/drivers/databricks-jdbc-2.6.40.jar. This is not easily fixed as databricks-jdbc is closed source.
      - timestamp: 2025-01-17T14:34:22Z
        type: pending-upstream-fix
        data:
          note: guava-31.1-jre.jar is not part of upstream repo. It is a transitive dependendcy of /flyway/drivers/databricks-jdbc-2.6.40.jar. This is not easily fixed as databricks-jdbc is closed source.
