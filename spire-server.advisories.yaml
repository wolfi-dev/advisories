schema-version: 2.0.2

package:
  name: spire-server

advisories:
  - id: CGA-26cj-j6h7-6x5h
    aliases:
      - CVE-2024-24790
      - GHSA-49gw-vxvf-fc2g
    events:
      - timestamp: 2024-06-07T19:10:27Z
        type: fixed
        data:
          fixed-version: 1.9.6-r1

  - id: CGA-3275-72p7-qvx6
    aliases:
      - CVE-2025-22869
    events:
      - timestamp: 2025-03-06T13:28:50Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 590b91daf441918e
            componentName: golang.org/x/crypto
            componentVersion: v0.32.0
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-03-12T07:37:30Z
        type: fixed
        data:
          fixed-version: 1.11.2-r3

  - id: CGA-39pp-cv7h-84fg
    aliases:
      - CVE-2025-22868
    events:
      - timestamp: 2025-03-06T13:28:40Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 41f5ce98070d0070
            componentName: golang.org/x/oauth2
            componentVersion: v0.25.0
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-03-12T15:32:16Z
        type: fixed
        data:
          fixed-version: 1.11.2-r4

  - id: CGA-3fpp-mf8w-5vj4
    aliases:
      - CVE-2025-30204
      - GHSA-mh63-6h87-95cp
    events:
      - timestamp: 2025-03-22T19:07:28Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 0d32a321cc891e98
            componentName: github.com/golang-jwt/jwt/v5
            componentVersion: v5.2.1
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2025-03-25T17:21:28Z
        type: fixed
        data:
          fixed-version: 1.12.0-r0

  - id: CGA-48fx-4272-c6m9
    aliases:
      - CVE-2023-48795
      - GHSA-45x7-px36-x8w8
    events:
      - timestamp: 2023-12-21T16:29:23Z
        type: fixed
        data:
          fixed-version: 1.8.6-r1

  - id: CGA-4hgv-xf5p-rf4v
    aliases:
      - CVE-2024-28180
      - GHSA-c5q2-7r4c-mv6g
    events:
      - timestamp: 2024-03-08T07:17:35Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-oidc-discovery-provider
            componentID: 38138f462c01d669
            componentName: github.com/go-jose/go-jose/v3
            componentVersion: v3.0.1
            componentType: go-module
            componentLocation: /usr/bin/oidc-discovery-provider
            scanner: grype
      - timestamp: 2024-03-08T16:05:34Z
        type: fixed
        data:
          fixed-version: 1.9.1-r1

  - id: CGA-5673-cwpv-3r26
    aliases:
      - CVE-2023-45283
      - GHSA-vvjp-q62m-2vph
    events:
      - timestamp: 2023-11-07T19:38:17Z
        type: false-positive-determination
        data:
          type: vulnerable-code-not-included-in-package
          note: Only affects Windows

  - id: CGA-5v2p-jc6w-xrc4
    aliases:
      - CVE-2024-29902
      - GHSA-88jx-383q-w4qc
    events:
      - timestamp: 2024-04-12T15:05:13Z
        type: fixed
        data:
          fixed-version: 1.9.4-r1

  - id: CGA-7gmj-qcm8-67pf
    aliases:
      - CVE-2025-22872
      - GHSA-vvgc-356p-c3xw
    events:
      - timestamp: 2025-04-17T19:35:52Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 17fae41a774fef29
            componentName: golang.org/x/net
            componentVersion: v0.37.0
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-04-18T23:20:06Z
        type: fixed
        data:
          fixed-version: 1.12.0-r2

  - id: CGA-855c-567x-gqfq
    aliases:
      - CVE-2024-45341
      - GHSA-3f6r-qh9c-x6mm
    events:
      - timestamp: 2025-02-01T02:16:40Z
        type: fixed
        data:
          fixed-version: 1.11.1-r2

  - id: CGA-8fc8-wj82-33f5
    aliases:
      - GHSA-2c7c-3mj9-8fqh
    events:
      - timestamp: 2023-11-22T16:41:27Z
        type: fixed
        data:
          fixed-version: 1.8.4-r2

  - id: CGA-8mgg-jf4h-3p2p
    aliases:
      - CVE-2023-45288
      - GHSA-4v7x-pqxf-cx7m
    events:
      - timestamp: 2024-04-11T20:23:04Z
        type: fixed
        data:
          fixed-version: 1.9.4-r0

  - id: CGA-9f9m-x72v-cf8q
    aliases:
      - CVE-2024-34155
      - GHSA-8xfx-rj4p-23jm
    events:
      - timestamp: 2024-09-10T20:42:08Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-agent
            componentID: 4d8f0aade96ff8da
            componentName: stdlib
            componentVersion: go1.23.0
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-03-19T22:05:45Z
        type: fixed
        data:
          fixed-version: 1.11.2-r5

  - id: CGA-9g37-7x64-vwv6
    aliases:
      - CVE-2025-22870
      - GHSA-qxp5-gwg8-xv66
    events:
      - timestamp: 2025-03-14T21:44:50Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 1ba0405833afe82b
            componentName: golang.org/x/net
            componentVersion: v0.34.0
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-03-16T03:13:00Z
        type: fixed
        data:
          fixed-version: 1.11.2-r5

  - id: CGA-9vw8-3w89-57gv
    aliases:
      - CVE-2020-8559
      - GHSA-33c5-9fx5-fvjm
    events:
      - timestamp: 2024-04-25T13:22:10Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: df130d84805f1ead
            componentName: k8s.io/apimachinery
            componentVersion: v0.29.2
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2025-03-19T22:05:45Z
        type: fixed
        data:
          fixed-version: 1.11.2-r5

  - id: CGA-9wh8-wr4v-226r
    aliases:
      - CVE-2025-46569
      - GHSA-6m8w-jc87-6cr7
    events:
      - timestamp: 2025-05-06T09:11:20Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 89dd908c7ad207cf
            componentName: github.com/open-policy-agent/opa
            componentVersion: v1.2.0
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2025-05-06T16:35:57Z
        type: fixed
        data:
          fixed-version: 1.12.0-r3

  - id: CGA-c3mv-f8f7-px4c
    aliases:
      - GHSA-xr7q-jx4m-x55m
    events:
      - timestamp: 2024-07-10T07:15:41Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-agent
            componentID: cf53bab56ffdf516
            componentName: google.golang.org/grpc
            componentVersion: v1.64.0
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-03-19T22:05:46Z
        type: fixed
        data:
          fixed-version: 1.11.2-r5

  - id: CGA-c7xc-5jqx-83xj
    aliases:
      - CVE-2023-45284
      - GHSA-rq3x-83w4-p28c
    events:
      - timestamp: 2023-11-07T19:38:18Z
        type: false-positive-determination
        data:
          type: vulnerable-code-not-included-in-package
          note: Only affects Windows

  - id: CGA-cvj3-47xv-4q3r
    aliases:
      - CVE-2023-46737
      - GHSA-vfp6-jrw2-99g9
    events:
      - timestamp: 2023-11-12T17:42:48Z
        type: fixed
        data:
          fixed-version: 1.8.4-r1

  - id: CGA-cx3w-5hg3-5wqf
    aliases:
      - CVE-2025-22871
      - GHSA-g9pc-8g42-g6vq
    events:
      - timestamp: 2025-04-10T15:34:04Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 8b22b7d1827c3a8d
            componentName: stdlib
            componentVersion: go1.24.1
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-04-11T14:24:56Z
        type: fixed
        data:
          fixed-version: 1.12.0-r1

  - id: CGA-f2fg-3pf2-h332
    aliases:
      - CVE-2024-34158
      - GHSA-j7vj-rw65-4v26
    events:
      - timestamp: 2024-09-10T20:42:21Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-agent
            componentID: 4d8f0aade96ff8da
            componentName: stdlib
            componentVersion: go1.23.0
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-03-19T22:05:47Z
        type: fixed
        data:
          fixed-version: 1.11.2-r5

  - id: CGA-fq5m-qff7-hf4g
    aliases:
      - GHSA-m7vp-hqwv-7m5x
    events:
      - timestamp: 2024-04-26T11:26:41Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 195ef9b2225d00d7
            componentName: github.com/spiffe/spire
            componentVersion: v0.0.0-20240405231231-028ad7403a5a
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2024-04-27T17:07:05Z
        type: false-positive-determination
        data:
          type: vulnerable-code-version-not-used
          note: This package uses a newer version v1.9.4 when the vulnerable code affects any version older than v1.0.3.

  - id: CGA-fr3q-p4jj-8785
    aliases:
      - CVE-2024-29018
      - GHSA-mq39-4gv4-mvpx
    events:
      - timestamp: 2024-03-21T11:42:18Z
        type: fixed
        data:
          fixed-version: 1.9.1-r4

  - id: CGA-g5q2-h4jr-h8vj
    aliases:
      - CVE-2024-24786
      - GHSA-8r3f-844c-mc37
    events:
      - timestamp: 2024-03-14T08:19:01Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 19d6028eb08424c3
            componentName: google.golang.org/protobuf
            componentVersion: v1.32.0
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2024-03-14T15:21:05Z
        type: fixed
        data:
          fixed-version: 1.9.1-r3

  - id: CGA-h3rv-rpfm-2c3r
    aliases:
      - CVE-2024-34156
      - GHSA-crqm-pwhx-j97f
    events:
      - timestamp: 2024-09-10T20:42:14Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-agent
            componentID: 4d8f0aade96ff8da
            componentName: stdlib
            componentVersion: go1.23.0
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-03-19T22:05:47Z
        type: fixed
        data:
          fixed-version: 1.11.2-r5

  - id: CGA-hjcw-vf2r-wh23
    aliases:
      - CVE-2024-28122
      - GHSA-hj3v-m684-v259
    events:
      - timestamp: 2024-03-09T08:38:07Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 11d8826f9ec1585f
            componentName: github.com/lestrrat-go/jwx/v2
            componentVersion: v2.0.19
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2024-03-10T16:02:15Z
        type: fixed
        data:
          fixed-version: 1.9.1-r2

  - id: CGA-hph5-25vw-7wwj
    aliases:
      - CVE-2025-22866
      - GHSA-3whm-j4xm-rv8x
    events:
      - timestamp: 2025-02-09T08:02:34Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: d4ba302d575bf003
            componentName: stdlib
            componentVersion: go1.23.5
            componentType: go-module
            componentLocation: /usr/bin/oidc-discovery-provider
            scanner: grype
      - timestamp: 2025-02-11T08:39:31Z
        type: fixed
        data:
          fixed-version: 1.11.1-r3

  - id: CGA-hpwx-25jh-jmh3
    aliases:
      - CVE-2024-6104
      - GHSA-v6v8-xj6m-xwqh
    events:
      - timestamp: 2024-06-25T08:11:52Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 506c49a9af775fd2
            componentName: github.com/hashicorp/go-retryablehttp
            componentVersion: v0.7.6
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2024-06-25T10:07:14Z
        type: fixed
        data:
          fixed-version: 1.10.0-r1

  - id: CGA-hx64-r6pw-g756
    aliases:
      - CVE-2024-21664
      - GHSA-pvcr-v8j8-j5q3
    events:
      - timestamp: 2024-01-24T07:11:22Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: ea84b18ae3298dd0
            componentName: github.com/lestrrat-go/jwx/v2
            componentVersion: v2.0.18
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2024-01-24T07:33:22Z
        type: fixed
        data:
          fixed-version: 1.8.7-r2

  - id: CGA-hxcq-j497-qcx5
    aliases:
      - CVE-2024-29903
      - GHSA-95pr-fxf5-86gv
    events:
      - timestamp: 2024-04-12T15:05:12Z
        type: fixed
        data:
          fixed-version: 1.9.4-r1

  - id: CGA-j57c-hq9f-363w
    aliases:
      - CVE-2025-27144
      - GHSA-c6gw-w398-hv78
    events:
      - timestamp: 2025-02-25T15:38:55Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 0ad674c1c1499a65
            componentName: github.com/go-jose/go-jose/v4
            componentVersion: v4.0.4
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-02-26T12:44:05Z
        type: fixed
        data:
          fixed-version: 1.11.2-r1
      - timestamp: 2025-02-27T14:20:09Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 1b158d3709c15b59
            componentName: github.com/go-jose/go-jose/v3
            componentVersion: v3.0.3
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2025-02-27T15:33:48Z
        type: fixed
        data:
          fixed-version: 1.11.2-r2

  - id: CGA-mcp7-m975-vqcg
    aliases:
      - CVE-2024-45338
      - GHSA-w32m-9786-jp63
    events:
      - timestamp: 2024-12-19T17:32:45Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: e2e2807099f4d970
            componentName: golang.org/x/net
            componentVersion: v0.31.0
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2024-12-20T17:06:08Z
        type: fixed
        data:
          fixed-version: 1.11.1-r1

  - id: CGA-mg75-7r2p-7m82
    aliases:
      - GHSA-jq35-85cj-fj4p
    events:
      - timestamp: 2023-10-31T16:32:53Z
        type: false-positive-determination
        data:
          type: vulnerable-code-not-in-execution-path
          note: Vulnerable code is part of the docker runtime and not being used in this package

  - id: CGA-mpvw-q85f-chh9
    aliases:
      - CVE-2024-35255
      - GHSA-m5vv-6r4h-3vj9
    events:
      - timestamp: 2024-06-12T09:25:50Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: dcd3f5cb4c2c7b2f
            componentName: github.com/Azure/azure-sdk-for-go/sdk/azidentity
            componentVersion: v1.5.2
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2024-06-12T12:32:43Z
        type: fixed
        data:
          fixed-version: 1.9.6-r2

  - id: CGA-p474-c7w3-xx37
    aliases:
      - CVE-2024-45336
      - GHSA-7wrw-r4p8-38rx
    events:
      - timestamp: 2025-02-01T02:16:32Z
        type: fixed
        data:
          fixed-version: 1.11.1-r2

  - id: CGA-p9pc-p5w6-x594
    aliases:
      - CVE-2024-47534
      - GHSA-4f8r-qqr9-fq8j
    events:
      - timestamp: 2024-10-10T09:44:43Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-agent
            componentID: 78e240d792be5782
            componentName: github.com/theupdateframework/go-tuf
            componentVersion: v0.7.0
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2024-10-10T22:21:12Z
        type: pending-upstream-fix
        data:
          note: |
            Spire currently relies on an affected version of 'go-tuf', which looks to have been depreciated in favor of 'go-tuf/v2'.
            There are significant changes between these releases, and attempting to upgrade results in build errors.
            Pending fix from upstream, which will involve removing their dependency on the depreciated version.
            Related information: https://github.com/github/advisory-database/pull/4893.

  - id: CGA-v452-6jxf-3ccc
    aliases:
      - CVE-2024-45337
      - GHSA-v778-237x-gjrc
    events:
      - timestamp: 2024-12-12T20:14:10Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 70e9603055d53930
            componentName: golang.org/x/crypto
            componentVersion: v0.28.0
            componentType: go-module
            componentLocation: /usr/bin/oidc-discovery-provider
            scanner: grype
      - timestamp: 2024-12-12T23:04:00Z
        type: fixed
        data:
          fixed-version: 1.11.1-r0

  - id: CGA-vw5g-2wg8-hwwf
    aliases:
      - GHSA-29qp-crvh-w22m
    events:
      - timestamp: 2025-01-31T13:30:31Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-server
            componentID: 0174753b5a058565
            componentName: github.com/hashicorp/yamux
            componentVersion: v0.1.1
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2025-01-31T18:14:03Z
        type: true-positive-determination
        data:
          note: 'Awaiting release of fix by upstream dependency yamux: https://github.com/hashicorp/yamux/pull/143'
      - timestamp: 2025-03-19T22:05:48Z
        type: fixed
        data:
          fixed-version: 1.11.2-r5

  - id: CGA-w383-9wx6-9qwj
    aliases:
      - GHSA-9763-4f94-gfch
    events:
      - timestamp: 2024-01-16T07:14:06Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-agent
            componentID: 03aa13c662bd2de4
            componentName: github.com/cloudflare/circl
            componentVersion: v1.3.5
            componentType: go-module
            componentLocation: /usr/bin/spire-agent
            scanner: grype
      - timestamp: 2024-01-24T07:11:08Z
        type: fixed
        data:
          fixed-version: 1.8.7-r1

  - id: CGA-w38h-6j4g-xq72
    aliases:
      - CVE-2024-24789
      - GHSA-236w-p7wf-5ph8
    events:
      - timestamp: 2024-06-07T19:10:31Z
        type: fixed
        data:
          fixed-version: 1.9.6-r1

  - id: CGA-x85f-fvcj-2jh3
    aliases:
      - CVE-2024-8260
      - GHSA-c77r-fh37-x2px
    events:
      - timestamp: 2024-09-21T07:18:10Z
        type: detection
        data:
          type: scan/v1
          data:
            subpackageName: spire-agent
            componentID: 32e0cf0f2af156e9
            componentName: github.com/open-policy-agent/opa
            componentVersion: v0.67.1
            componentType: go-module
            componentLocation: /usr/bin/spire-server
            scanner: grype
      - timestamp: 2025-03-19T22:05:49Z
        type: fixed
        data:
          fixed-version: 1.11.2-r5
